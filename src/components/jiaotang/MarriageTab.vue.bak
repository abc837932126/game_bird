<template>

		<!-- å©šæ¦œåˆ—è¡¨ -->
		<div v-if="marriageHistory.length > 0" class="grid grid-cols-2 gap-2 ">
			<el-card
				v-for="record in marriageHistory"
				:key="record.id"
				class="marriage-card"
			>
				<!-- æ–°äººå¤´åƒ -->
				<div class="flex items-center justify-center gap-4 mb-4">
					<PlayerAvatar
						:player-id="record.groom.id"
						:sex="record.groom.sex"
						:avatar-frame-id="record.groom.avatar_frame_id"
						:size="60"
					/>
					<span class="text-2xl">ğŸ’•</span>
					<PlayerAvatar
						:player-id="record.bride.id"
						:sex="record.bride.sex"
						:avatar-frame-id="record.bride.avatar_frame_id"
						:size="60"
					/>
				</div>

				<!-- æ–°äººæ˜µç§° -->
				<div class="text-center mb-2 font-bold text-lg">
					<span>{{ record.groom.nickname }}</span>
					<span class="mx-2 text-red-500">&</span>
					<span>{{ record.bride.nickname }}</span>
				</div>

				<!-- ç»“å©šæ—¶é—´ -->
				<div class="text-gray-500 text-sm text-center mb-3">
					{{ formatTime(record.marriageDate) }}
				</div>

				<!-- ç¥ç¦æ•°é‡ -->
				<div class="flex items-center justify-center">
					<el-tag type="success" size="small">
						æ”¶åˆ° {{ record.blessCount }} ä»½ç¥ç¦
					</el-tag>
				</div>
			</el-card>
		</div>

		<!-- ç©ºçŠ¶æ€ -->
		<div v-else class="text-center py-12 text-gray-400">
			<div class="text-6xl mb-4">ğŸ’’</div>
			<div class="text-lg">æš‚æ— ç»“å©šè®°å½•</div>
			<div class="text-sm mt-2">æœŸå¾…æ›´å¤šç©å®¶å–œç»“è¿ç†ï¼</div>
		</div>

</template>

<script setup>
import { inject, computed } from 'vue'
import PlayerAvatar from '../common/PlayerAvatar.vue'

const game = inject('game')

// è·å–ç»“å©šå†å²è®°å½•
const marriageHistory = computed(() => {
	const history = game.game_marriage.data.history || []
	// è°ƒè¯•ï¼šæ‰“å°ç¬¬ä¸€æ¡è®°å½•æŸ¥çœ‹æ•°æ®ç»“æ„
	if (history.length > 0) {
		console.log('[å©šæ¦œ] ç¬¬ä¸€æ¡è®°å½•:', history[0])
	}
	return history
})

// æ—¶é—´æ ¼å¼åŒ–
const formatTime = (time) => {
	const date = new Date(time)
	const year = date.getFullYear()
	const month = String(date.getMonth() + 1).padStart(2, '0')
	const day = String(date.getDate()).padStart(2, '0')
	const hour = String(date.getHours()).padStart(2, '0')
	const minute = String(date.getMinutes()).padStart(2, '0')
	return `${year}-${month}-${day} ${hour}:${minute}`
}
</script>

<style scoped>
.marriage-card {
	transition: all 0.3s ease;
}

.marriage-card:hover {
	transform: translateY(-2px);
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}
</style>
